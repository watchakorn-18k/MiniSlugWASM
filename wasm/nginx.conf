server {
    listen 80;
    server_name localhost;
    root /usr/share/nginx/html;
    index index.html minislug.html;

    # WASM MIME types
    location ~* \.wasm$ {
        types { application/wasm wasm; }
        add_header Cross-Origin-Embedder-Policy require-corp;
        add_header Cross-Origin-Opener-Policy same-origin;
    }

    # Enable gzip for better performance
    gzip on;
    gzip_types application/javascript application/wasm text/html text/css;

    # Minislug game HTML (Strict isolation for WASM stability)
    location = /minislug.html {
        add_header Cross-Origin-Embedder-Policy require-corp;
        add_header Cross-Origin-Opener-Policy same-origin;
        add_header Cache-Control "no-store, no-cache, must-revalidate";
    }

    # Standard routes (Relaxed headers for Landing Page to allow CDNs)
    location / {
        try_files $uri $uri/ =404;
        add_header Cache-Control "no-store, no-cache, must-revalidate";
    }
}
